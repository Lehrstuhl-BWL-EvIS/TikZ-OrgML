\documentclass[border=20pt]{standalone}
\usepackage[utf8]{inputenc}
\usepackage[ngerman]{babel}

%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
%~~ Laden von TikZ
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\usepackage{tikz}

%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
%~~  __  __ ___ __  __  ___     ___           __  __ _    
%~~ |  \/  | __|  \/  |/ _ \   / _ \ _ _ __ _|  \/  | |   
%~~ | |\/| | _|| |\/| | (_) | | (_) | '_/ _` | |\/| | |__ 
%~~ |_|  |_|___|_|  |_|\___/   \___/|_| \__, |_|  |_|____|
%~~                                     |___/             
%~~  ___ _                      
%~~ / __| |_  __ _ _ __  ___ ___
%~~ \__ \ ' \/ _` | '_ \/ -_|_-<
%~~ |___/_||_\__,_| .__/\___/__/
%~~               |_|   
%~~
%~~ Definition der MEMO OrgML Notationssymbole als Shapes für TikZ Nodes
%~~
%~~ ##########################################################################
%~~ ToDo-Liste:
%~~         ToDo Größe der Shapes dynamisch berechnen?
%~~         ToDo Auslagerung der Shapes und Macros in ein *.sty-File
%~~         ToDo Textnode in Macro durch Label ersetzen? (Vgl. S. 238ff)
%~~         ToDo Implementierung der UND und ODER Notationssymbole für die 
%~~              Synchronisation
%~~         ToDo Unterscheidung von öffentlichen und internen Macros?
%~~         ToDo Eigenes Macro, dass den Split korrekt ausführt und das Ver-
%~~              Verbindungsstück einfügt --> dynamische Berechnung der
%~~              der Position des Verbindungsstückes
%~~         ToDo Teilung der Implementierung der Symbols und der Macros?
%~~              --> ggf. kann die Logik der Macros auch für TikZ-Pics
%~~                  verwendet werden
%~~         ToDo Anzahl der möglichen, parallel ausführbaren Prozesse ermitteln
%~~         ToDo Linienstil mit runden Abschluss definieren --> globaler Style
%~~              für alle Shapes definieren
%~~         ToDo Erhöhung der Linienstärke für die Verbindungslinien
%~~         ToDo Umbenennen der Verbindungsstücke --> Linke Verbindung wird nicht
%~~              benötigt
%~~         ToDo 
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
%~~ TikZ-Libraries
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\usetikzlibrary{trees}

%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
%~~ Farben
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\definecolor{event}{RGB}{198,212,220}
\definecolor{startevent}{RGB}{162,180,0}
\definecolor{endevent}{RGB}{200,0,52}

%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
%~~ TikZ-Styles
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
%~~ ######################################
%~~ EREIGNISSE
%~~ ######################################

\tikzset{
    event/.style={
        draw,
        inner sep=3ex,
        color=event
    }
}

\tikzset{
    startevent/.style={
        event,
        color=startevent
    }
}

\tikzset{
    endevent/.style={
        event,
        color=endevent
    }
}

\tikzset{
    msgevent/.style={
        event
    }
}

\tikzset{
    chgevent/.style={
        event
    }
}

%~~ ######################################
%~~ PROZESSE
%~~ ######################################

\tikzset{
    unspecprocess/.style={
        draw,
        inner sep=2.5ex,
        text width=5em,
        level distance=6ex,
        sibling distance=10ex
    }
}

\tikzset{
    decompprocess/.style={
        unspecprocess
    }
}

%~~ ######################################
%~~ SYNCHRONISATION
%~~ ######################################

\tikzset{
    sync/.style={
        draw,
        inner sep=2.5ex,        
    }
}

\tikzset{
    andsync/.style={
        sync      
    }
}

\tikzset{
    orsync/.style={
        sync      
    }
}

%~~ ######################################
%~~ TEXTNODES
%~~ ######################################

\tikzset{
    memotext/.style={
        below,
        align=center,
        font=\footnotesize\sffamily        
    }
}

%~~ ######################################
%~~ VERBINDUNGSLINIEN
%~~ ######################################
\tikzset{
    memoline/.style={
        line width=0.75pt  
    }
}

%~~ ######################################
%~~ VERBINDUNGSSTÜCKE
%~~ ######################################

\tikzset{
    paraconn/.style={}
}

\tikzset{
    syncconn/.style={}
}

%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
%~~ Definition der MEMO OrgML-Shapes
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

\makeatletter
%~~ ######################################
%~~ EREIGNISSE
%~~ ######################################

%~~ Basisereignis
\pgfdeclareshape{event}{
    %~~ Übernahme der Anchor aus dem standard Rechteck
    %~~ Shape
    \inheritsavedanchors[from=rectangle]  	        
	\inheritanchorborder[from=rectangle] 
	\inheritanchor[from=rectangle]{center} 
	\inheritanchor[from=rectangle]{north}
 	\inheritanchor[from=rectangle]{south} 
	\inheritanchor[from=rectangle]{west} 
	\inheritanchor[from=rectangle]{east}

    
    %~~ Hintergrundpfad des Basisereignisses       
	\backgroundpath{
        %~~ Speichern der Werte der Anker in den 
        %~~ temporären PGF Registern xa,ya und xb und yb
	    \southwest \pgf@xa=\pgf@x \pgf@ya=\pgf@y
	    \northeast \pgf@xb=\pgf@x \pgf@yb=\pgf@y
			    
	    %~~ Setzen der Linienstärke
		\pgfsetlinewidth{0.75pt}
									
        %~~ Erzeugen der äußeren Kanten des Notationssymbols
        %~~ mit Hilfe eines Path (Dreieck}
        \pgfpathmoveto{\pgfpoint{\pgf@xa}{\pgf@yb}}   
        \pgfpathlineto{\pgfpoint{\pgf@xb}{\pgf@yb}}
        \pgfpathlineto{\pgfpoint{\pgf@xb*0}{\pgf@ya}}
        \pgfpathlineto{\pgfpoint{\pgf@xa}{\pgf@yb}}
    	    	    			
    	%~~ Erzeugen des Pfades
    	\pgfusepath{stroke} 	
    			
    	%~~ Abschluss des Pfades   		
    	\pgfpathclose  	    				
    }
}

%~~ Bezeichner für spezielle Ereignisse:
%~~ ?????event, z.B. startevent, endevent, etc.

%~~ Startereignis
\pgfdeclareshape{startevent}{
    %~~ Die Anchor werden aus dem Basisshape für Events
    %~~ geerbt
	\inheritsavedanchors[from=event]  	        
	\inheritanchorborder[from=event] 
	\inheritanchor[from=event]{center} 
	\inheritanchor[from=event]{north}
 	\inheritanchor[from=event]{south} 
	\inheritanchor[from=event]{west} 
	\inheritanchor[from=event]{east}
	
	
	%~~ Erben des Hintergrundpfades aus dem Basisshape
	%~~ für Events
	\inheritbackgroundpath[from=event]
	
	%~~ Erzeugen des Textes "START" überhalb des Events
	\beforebackgroundpath{
	    %~~ Speichern der Werte der Anker in den 
        %~~ temporären PGF Registern xa,ya und xb und yb
	    \southwest \pgf@xa=\pgf@x \pgf@ya=\pgf@y
	    \northeast \pgf@xb=\pgf@x \pgf@yb=\pgf@y
	
	    %~~ Erzeugen des Textes über dem Dreieck
	    %~~ Die Positionierung erfolgt dabei relativ zu den Ankern
    	\pgftext[left, x=\pgf@xb*-.2, y=\pgf@yb*1.25]{\textsf{\fontsize{1}{5}\selectfont START}}
	}
}

%~~ Endereignis
\pgfdeclareshape{endevent}{
    %~~ Die Anchor werden aus dem Basisshape für Events
    %~~ geerbt
	\inheritsavedanchors[from=event]  	        
	\inheritanchorborder[from=event] 
	\inheritanchor[from=event]{center} 
	\inheritanchor[from=event]{north}
 	\inheritanchor[from=event]{south} 
	\inheritanchor[from=event]{west} 
	\inheritanchor[from=event]{east}
	
	
	%~~ Erben des Hintergrundpfades aus dem Basisshape
	%~~ für Events
	\inheritbackgroundpath[from=event]
	
	%~~ Erzeugen des Textes "STOP" überhalb des Events
	\beforebackgroundpath{
	    %~~ Speichern der Werte der Anker in den 
        %~~ temporären PGF Registern xa,ya und xb und yb
	    \southwest \pgf@xa=\pgf@x \pgf@ya=\pgf@y
	    \northeast \pgf@xb=\pgf@x \pgf@yb=\pgf@y
	
	    %~~ Erzeugen des Textes über dem Dreieck
	    %~~ Die Positionierung erfolgt dabei relativ zu den Ankern
    	\pgftext[left, x=\pgf@xb*-.1, y=\pgf@yb*1.25]{\textsf{\fontsize{1}{5}\selectfont STOP}}
	}
}

%~~ Nachricht eingegangen
\pgfdeclareshape{msgevent}{
    %~~ Die Anchor werden aus dem Basisshape für Events
    %~~ geerbt
	\inheritsavedanchors[from=event]  	        
	\inheritanchorborder[from=event] 
	\inheritanchor[from=event]{center} 
	\inheritanchor[from=event]{north}
 	\inheritanchor[from=event]{south} 
	\inheritanchor[from=event]{west} 
	\inheritanchor[from=event]{east}
	
	
	%~~ Erben des Hintergrundpfades aus dem Basisshape
	%~~ für Events
	\inheritbackgroundpath[from=event]
	
	%~~ Erzeugen des Briefumschlages 
	\beforebackgroundpath{
	    %~~ Speichern der Werte der Anker in den 
        %~~ temporären PGF Registern xa,ya und xb und yb
	    \southwest \pgf@xa=\pgf@x \pgf@ya=\pgf@y
	    \northeast \pgf@xb=\pgf@x \pgf@yb=\pgf@y
    	
    	%~~ Definition der Farben für den Briefumschlag und
    	%~~ den Hintergrund
    	\definecolor{black}{RGB}{20,18,21}
    	\pgfsetcolor{black}
    	%~~ Hintergrund
    	\pgfsetfillcolor{white}
    	
    	%~~ Rahmen für den Briefumschlag
    	\begin{pgfscope}
    	    %~~ Die äußere Linienstärke wird innerhalb des Scope
    	    %~~ definiert
    	    \pgfsetlinewidth{0.75pt}
    	    \pgfpathmoveto{\pgfpoint{\pgf@xb*-0.75}{\pgf@yb*0.75}}   
            \pgfpathlineto{\pgfpoint{\pgf@xb*0.75}{\pgf@yb*0.75}}
            \pgfpathlineto{\pgfpoint{\pgf@xb*0.75}{\pgf@yb*-0.35}}
            \pgfpathlineto{\pgfpoint{\pgf@xb*-0.75}{\pgf@yb*-0.35}}
            \pgfpathlineto{\pgfpoint{\pgf@xb*-0.75}{\pgf@yb*0.75}}
            \pgfusepath{stroke,fill}
        \end{pgfscope}
        
        %~~ Faltkanten des Briefumschlges
	    \pgfpathmoveto{\pgfpoint{\pgf@xb*-0.75}{\pgf@yb*0.75}}
	    \pgfpathlineto{\pgfpoint{\pgf@xb*0}{\pgf@yb*0.15}}
	    \pgfpathlineto{\pgfpoint{\pgf@xb*0.75}{\pgf@yb*0.75}}
	    
	    \pgfpathmoveto{\pgfpoint{\pgf@xb*-0.75}{\pgf@yb*-0.35}}
	    \pgfpathlineto{\pgfpoint{\pgf@xb*-0.15}{\pgf@yb*0.25}}
	    
	    \pgfpathmoveto{\pgfpoint{\pgf@xb*0.75}{\pgf@yb*-0.35}}
	    \pgfpathlineto{\pgfpoint{\pgf@xb*0.15}{\pgf@yb*0.25}}        
	    
    	\pgfusepath{stroke}
    	
    	\pgfpathclose
	}
}

%~~ Relevante Änderung des Informationszustandes
\pgfdeclareshape{chgevent}{
    %~~ Die Anchor werden aus dem Basisshape für Events
    %~~ geerbt
	\inheritsavedanchors[from=event]  	        
	\inheritanchorborder[from=event] 
	\inheritanchor[from=event]{center} 
	\inheritanchor[from=event]{north}
 	\inheritanchor[from=event]{south} 
	\inheritanchor[from=event]{west} 
	\inheritanchor[from=event]{east}
	
	
	%~~ Erben des Hintergrundpfades aus dem Basisshape
	%~~ für Events
	\inheritbackgroundpath[from=event]
	
	%~~ Erzeugen des Aktensymbols 
	\beforebackgroundpath{
	    %~~ Speichern der Werte der Anker in den 
        %~~ temporären PGF Registern xa,ya und xb und yb
	    \southwest \pgf@xa=\pgf@x \pgf@ya=\pgf@y
	    \northeast \pgf@xb=\pgf@x \pgf@yb=\pgf@y
    	
    	%~~ Schwarze Linien und Hintergrundfarbe
    	\definecolor{border}{RGB}{20,18,21}
    	%~~ Vordergrundfarbe der Aktenmappe
    	\definecolor{briefcase}{RGB}{255,253,232}
    	\pgfsetcolor{border}
    	
    	%~~ Erzeugen des schwarzen Hintergrundes, der signalisiert,
    	%~~ das die Aktenmappe geöffnet ist
    	\begin{pgfscope}
            \pgfsetfillcolor{border}
            \pgfpathmoveto{\pgfpoint{\pgf@xb*-0.63}{\pgf@yb*0.75}}   
            \pgfpathlineto{\pgfpoint{\pgf@xb*-0.25}{\pgf@yb*0.75}}
            \pgfpathlineto{\pgfpoint{\pgf@xb*-0.26}{\pgf@yb*0.65}}
            \pgfpathlineto{\pgfpoint{\pgf@xb*0.75}{\pgf@yb*0.65}}
            \pgfpathlineto{\pgfpoint{\pgf@xb*0.65}{\pgf@yb*-0.35}}
            \pgfpathlineto{\pgfpoint{\pgf@xb*-0.65}{\pgf@yb*-0.35}}
            \pgfpathlineto{\pgfpoint{\pgf@xb*-0.63}{\pgf@yb*0.75}}
            \pgfusepath{stroke,fill}
        \end{pgfscope}  
            	
    	%~~ Erzeugen des Deckblatts der Aktenmappe
    	\begin{pgfscope}
    	    %~~ Setzen der Farbe
    	    \pgfsetfillcolor{briefcase}
    	    \pgfpathmoveto{\pgfpoint{\pgf@xb*-0.75}{\pgf@yb*0.65}}   
            \pgfpathlineto{\pgfpoint{\pgf@xb*-0.35}{\pgf@yb*0.65}}
            \pgfpathlineto{\pgfpoint{\pgf@xb*-0.35}{\pgf@yb*0.55}}
            \pgfpathlineto{\pgfpoint{\pgf@xb*0.65}{\pgf@yb*0.55}}  
            \pgfpathlineto{\pgfpoint{\pgf@xb*0.65}{\pgf@yb*-0.35}}
            \pgfpathlineto{\pgfpoint{\pgf@xb*-0.75}{\pgf@yb*-0.35}}          
            \pgfpathlineto{\pgfpoint{\pgf@xb*-0.75}{\pgf@yb*0.65}}
            \pgfusepath{stroke,fill}
        \end{pgfscope}        
            	
    	\pgfpathclose
	}
}


%~~ ######################################
%~~ PROZESSE
%~~ ######################################

%~~ Unspezifizierter Prozess
\pgfdeclareshape{unspecprocess}{
    %~~ Übernahme der Anchors aus dem
    %~~ Rechteck
	\inheritsavedanchors[from=rectangle]  	        
	\inheritanchorborder[from=rectangle] 
	\inheritanchor[from=rectangle]{center} 
	\inheritanchor[from=rectangle]{north}
 	\inheritanchor[from=rectangle]{south} 
	\inheritanchor[from=rectangle]{west} 
	\inheritanchor[from=rectangle]{east}
            
	%~~ Hintergrundpfad des Basisprozesses
	\backgroundpath{
        %~~ Speichern der Werte der Anker in den 
        %~~ temporären PGF Registern xa,ya und xb und yb
		\southwest \pgf@xa=\pgf@x \pgf@ya=\pgf@y
		\northeast \pgf@xb=\pgf@x \pgf@yb=\pgf@y
				
		%~~ Definition der Farbe für die Linien und
		%~~ den Hintergrund des Shapes
		\definecolor{background}{RGB}{198,212,220}
		\pgfsetcolor{background}
				
    	%~~ Erzeugen des Notationssymbols eines
    	%~~ unspezifierten Prozesses   
    	\pgfpathmoveto{\pgfpoint{\pgf@xa}{\pgf@ya}}
    	\pgfpathlineto{\pgfpoint{\pgf@xa}{\pgf@yb}}
    	\pgfpathlineto{\pgfpoint{\pgf@xb*0.75}{\pgf@yb}}
    	\pgfpathlineto{\pgfpoint{\pgf@xb}{0}}
    	\pgfpathlineto{\pgfpoint{\pgf@xb*0.75}{\pgf@ya}}
    		
    	%~~ Erzeugen des Pfades und Setzen der Hintergrundfarbe
    	\pgfusepath{fill,stroke}
    	
    	%~~ Abschluss des Pfades
    	\pgfpathclose  	    			
 	}
}

\pgfdeclareshape{decompprocess}{
    %~~ Übernahme der Anchors aus dem
    %~~ Rechteck
	\inheritsavedanchors[from=unspecprocess]  	        
	\inheritanchorborder[from=unspecprocess] 
	\inheritanchor[from=unspecprocess]{center} 
	\inheritanchor[from=unspecprocess]{north}
 	\inheritanchor[from=unspecprocess]{south} 
	\inheritanchor[from=unspecprocess]{west} 
	\inheritanchor[from=unspecprocess]{east}
            
	%~~ Hintergrundpfad des unspezifizierten Prozesses erben
	\inheritbackgroundpath[from=unspecprocess]

    %~~ Erzeugen der Dekompositionshierarchie innerhalb des Prozesses
    \beforebackgroundpath{
        \southwest \pgf@xa=\pgf@x \pgf@ya=\pgf@y
		\northeast \pgf@xb=\pgf@x \pgf@yb=\pgf@y
		
		%~~ Linienfarbe
    	\definecolor{black}{RGB}{20,18,21}
    	\pgfsetcolor{black}
    	
    	%~~ Hintergrund
    	\definecolor{beige}{RGB}{255,253,232}
    	\pgfsetfillcolor{beige}
    	
    	%~~ Linienstärke
    	\pgfsetlinewidth{0.75pt}
    	
    	%~~ Zentraler Prozess
    	\pgfpathmoveto{\pgfpoint{\pgf@xb*0.2}{\pgf@yb*0.85}}
    	\pgflineto{\pgfpoint{\pgf@xb*0.45}{\pgf@yb*0.85}}
    	\pgflineto{\pgfpoint{\pgf@xb*0.52}{\pgf@yb*0.55}}
    	\pgflineto{\pgfpoint{\pgf@xb*0.45}{\pgf@yb*0.25}}
    	\pgflineto{\pgfpoint{\pgf@xb*0.2}{\pgf@yb*0.25}}
    	\pgflineto{\pgfpoint{\pgf@xb*0.2}{\pgf@yb*0.85}}

        %~~ Linker Prozess
    	\pgfpathmoveto{\pgfpoint{\pgf@xb*0}{\pgf@yb*-0.2}}
    	\pgflineto{\pgfpoint{\pgf@xb*0.25}{\pgf@yb*-0.2}}
    	\pgflineto{\pgfpoint{\pgf@xb*0.32}{\pgf@yb*-0.5}}
    	\pgflineto{\pgfpoint{\pgf@xb*0.25}{\pgf@yb*-0.8}}
    	\pgflineto{\pgfpoint{\pgf@xb*0}{\pgf@yb*-0.8}}
    	\pgflineto{\pgfpoint{\pgf@xb*0}{\pgf@yb*-0.2}}
    	
    	%~~ Rechter Prozess
        \pgfpathmoveto{\pgfpoint{\pgf@xb*0.4}{\pgf@yb*-0.2}}
    	\pgflineto{\pgfpoint{\pgf@xb*0.65}{\pgf@yb*-0.2}}
    	\pgflineto{\pgfpoint{\pgf@xb*0.72}{\pgf@yb*-0.5}}
    	\pgflineto{\pgfpoint{\pgf@xb*0.65}{\pgf@yb*-0.8}}
    	\pgflineto{\pgfpoint{\pgf@xb*0.4}{\pgf@yb*-0.8}}
    	\pgflineto{\pgfpoint{\pgf@xb*0.4}{\pgf@yb*-0.2}}
    	    	
    	%~~ Dekompositionslinien
    	\pgfpathmoveto{\pgfpoint{\pgf@xb*0.36}{\pgf@yb*0.2}}
    	\pgflineto{\pgfpoint{\pgf@xb*0.36}{\pgf@yb*0.05}}
    	
    	\pgfpathmoveto{\pgfpoint{\pgf@xb*0.16}{\pgf@yb*0.05}}
    	\pgflineto{\pgfpoint{\pgf@xb*0.56}{\pgf@yb*0.05}}
    	
        \pgfpathmoveto{\pgfpoint{\pgf@xb*0.16}{\pgf@yb*0.05}}
        \pgflineto{\pgfpoint{\pgf@xb*0.16}{\pgf@yb*-0.1}}
        
        \pgfpathmoveto{\pgfpoint{\pgf@xb*0.56}{\pgf@yb*0.05}}
        \pgflineto{\pgfpoint{\pgf@xb*0.56}{\pgf@yb*-0.1}}
    	
    	%~~ Erzeugen der Pfade und Setzen der Hintergrundfarben
    	\pgfusepath{stroke,fill}
    	
    	%~~ Abschluss des Pfades
    	\pgfpathclose
    }
}

%~~ ######################################
%~~ SYNCHRONISATION
%~~ ######################################

%~~ Generisches Notationssymbol für die Synchronisierung
\pgfdeclareshape{sync}{
    %~~ Übernahme der Anchors aus dem
    %~~ Rechteck
	\inheritsavedanchors[from=rectangle]  	        
	\inheritanchorborder[from=rectangle] 
	\inheritanchor[from=rectangle]{center} 
	\inheritanchor[from=rectangle]{north}
 	\inheritanchor[from=rectangle]{south} 
	\inheritanchor[from=rectangle]{west} 
	\inheritanchor[from=rectangle]{east}
            
	%~~ Hintergrundpfad des Synchronisationssymbols
	\backgroundpath{
        %~~ Speichern der Werte der Anker in den 
        %~~ temporären PGF Registern xa,ya und xb und yb
		\southwest \pgf@xa=\pgf@x \pgf@ya=\pgf@y
		\northeast \pgf@xb=\pgf@x \pgf@yb=\pgf@y
		
		%~~ Farbe der Kantenlinien
		\definecolor{edge}{RGB}{4,66,84}
		\pgfsetcolor{edge}
		
		%~~ Hintergrund
		\definecolor{fill}{RGB}{218,229,235}
		\pgfsetfillcolor{fill}
			
		\pgfsetlinewidth{0.75pt}
		\pgfpathmoveto{\pgfpoint{\pgf@xb*0}{\pgf@yb}}
    	\pgflineto{\pgfpoint{\pgf@xb}{\pgf@yb*0}}
    	\pgflineto{\pgfpoint{\pgf@xb*0}{\pgf@ya}}
    	\pgflineto{\pgfpoint{\pgf@xa}{\pgf@yb*0}}
        \pgflineto{\pgfpoint{\pgf@xb*0}{\pgf@yb}}
    		
    	%~~ Erzeugen des Pfades und Setzen der Hintergrundfarbe
    	\pgfusepath{stroke,fill}
    	
    	%~~ Abschluss des Pfades
    	\pgfpathclose  	    			
 	}
}

%~~ Notationssymbols zur Synchronisation nach Beendigung aller Prozesse
\pgfdeclareshape{andsync}{
    %~~ Übernahme der Anchors aus dem
    %~~ Rechteck
	\inheritsavedanchors[from=sync]  	        
	\inheritanchorborder[from=sync] 
	\inheritanchor[from=sync]{center} 
	\inheritanchor[from=sync]{north}
 	\inheritanchor[from=sync]{south} 
	\inheritanchor[from=sync]{west} 
	\inheritanchor[from=sync]{east}
            
	%~~ Hintergrundpfad des generischen Synchronisationssymbols
	%~~ erben
	\inheritbackgroundpath[from=sync]
    
    %~~ Erzeugen des Texts AND im Notationssymbl
    \beforebackgroundpath{
        %~~ Speichern der Werte der Anker in den 
        %~~ temporären PGF Registern xa,ya und xb und yb
	    \southwest \pgf@xa=\pgf@x \pgf@ya=\pgf@y
	    \northeast \pgf@xb=\pgf@x \pgf@yb=\pgf@y
	    
	    %~~ Farbe der Kantenlinien
		\definecolor{text}{RGB}{4,66,84}
		\pgfsetcolor{text}
	
	    %~~ Erzeugen des Textes AND innerhalb des Symbols
	    \pgftext[left, x=\pgf@xb*-0.5, y=\pgf@yb*0]{\textsf{\fontsize{1}{5}\selectfont AND}}
    }	
}

%~~ Notationssymbol zur Synchronisation nach Beendigung des ersten Prozesses 
\pgfdeclareshape{orsync}{
    %~~ Übernahme der Anchors aus dem
    %~~ Rechteck
	\inheritsavedanchors[from=sync]  	        
	\inheritanchorborder[from=sync] 
	\inheritanchor[from=sync]{center} 
	\inheritanchor[from=sync]{north}
 	\inheritanchor[from=sync]{south} 
	\inheritanchor[from=sync]{west} 
	\inheritanchor[from=sync]{east}
            
	%~~ Hintergrundpfad des generischen Synchronisationssymbols
	%~~ erben
	\inheritbackgroundpath[from=sync]
    
    %~~ Erzeugen des Texts AND im Notationssymbl
    \beforebackgroundpath{
        %~~ Speichern der Werte der Anker in den 
        %~~ temporären PGF Registern xa,ya und xb und yb
	    \southwest \pgf@xa=\pgf@x \pgf@ya=\pgf@y
	    \northeast \pgf@xb=\pgf@x \pgf@yb=\pgf@y
	    
	    %~~ Farbe der Kantenlinien
		\definecolor{text}{RGB}{4,66,84}
		\pgfsetcolor{text}
	
	    %~~ Erzeugen des Textes AND innerhalb des Symbols
	    \pgftext[left, x=\pgf@xb*-0.5, y=\pgf@yb*0]{\textsf{\fontsize{7}{5}\selectfont OR}}
    }	
}



%~~ ######################################
%~~ VERBINDUNGSSTÜCKE
%~~ ######################################

%~~ Verbindungsstück für die parallele Prozessausführung
\pgfdeclareshape{paraconn}{
    %~~ Übernahme der Anchors aus dem
    %~~ Rechteck
	\inheritsavedanchors[from=rectangle]  	        
	\inheritanchorborder[from=rectangle] 
	\inheritanchor[from=rectangle]{center} 
	\inheritanchor[from=rectangle]{north}
 	\inheritanchor[from=rectangle]{south} 
	\inheritanchor[from=rectangle]{west} 
	\inheritanchor[from=rectangle]{east}
            
	%~~ Hintergrundpfad des Basisprozesses
	\backgroundpath{
        %~~ Speichern der Werte der Anker in den 
        %~~ temporären PGF Registern xa,ya und xb und yb
		\southwest \pgf@xa=\pgf@x \pgf@ya=\pgf@y
		\northeast \pgf@xb=\pgf@x \pgf@yb=\pgf@y
				
        \pgfsetlinewidth{0.75pt}
    	%~~ Erzeugen des Verbindungsstückes für die
    	%~~ parallele Ausführung von Prozessen  
    	\pgfpathmoveto{\pgfpoint{\pgf@xb*0}{\pgf@ya}}
    	\pgfpathlineto{\pgfpoint{\pgf@xb*0}{\pgf@yb}}
    	\pgfpathmoveto{\pgfpoint{\pgf@xb*0}{\pgf@yb*0}}
    	\pgfpathlineto{\pgfpoint{\pgf@xb*-1}{\pgf@yb*0}}
    	
    	%~~ Erzeugen der doppelten Linien
    	\pgfpathmoveto{\pgfpoint{\pgf@xb*-1.8}{\pgf@yb*0.4}}
    	\pgflineto{\pgfpoint{\pgf@xb*-1.1}{\pgf@yb*0.4}}
    	\pgfpathmoveto{\pgfpoint{\pgf@xb*-1.8}{\pgf@yb*-0.4}}
    	\pgflineto{\pgfpoint{\pgf@xb*-1.1}{\pgf@yb*-0.4}}
    	    		
    	%~~ Erzeugen des Pfades und Setzen der Hintergrundfarbe
    	\pgfusepath{stroke}
    	
    	%~~ Abschluss des Pfades
    	\pgfpathclose  	    			
 	}
}
\makeatother

%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
%~~ LaTeX-Macros
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

%~~
%~~ Vorlage für die Beschreibung der Macors
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% Macroname: 
% Funktion:  
% Parameter: 
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% Macroname: memonode
% Funktion:  Erzeugen eines MEMO OrgML Notationssymbols mit dem passenden
%            Shape, an der definierten Stelle mit dem definierten Text
% Parameter: #1: Name des zu verwendenden Shapes
%            #2: Name des Nodes der erzeugt wird
%            #3: x-Position
%            #4: y-Position
%            #5: Beschreibung des Ereignisses/Prozesses
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\newcommand{\memonode}[5]{
    %~~ Erzeugen des Nodes der das Notationssymbol darstellt.
    %~~ Die Verwendung des richtigen Styles wird durch die Namensgleichheit
    %~~ des Styles und des Shapes erreicht.
    \node[#1, shape=#1] (#2) at (#3,#4) {};
        
    %~~ Erzeugen des Textes (Node) unterhalb des Notationssymbol der
    %~~ das Ereignis bzw. den Prozess beschreibt
    \node[memotext] at (#2.south) {#5};
}

%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% Macroname: memoconn
% Funktion:  Gerade Verbindung von Prozessen und Ereignissen
% Parameter: #1: Linkes Notationssymbol
%            #2: Rechtes Notationssymbol
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\newcommand{\memoconn}[2]{
    \draw[memoline] (#1) -- (#2);
}

%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% Macroname: memoconnpara
% Funktion:  Erzeugen einer parallelen Ausführung von Prozessen
% Parameter: #1: Ausgangsereignis
%            #2: Erster Prozess
%            #3: Zweiter Prozess
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\newcommand{\memoconnpara}[3]{
    \draw[memoline] (#1) |- (#2);
    \draw[memoline] (#1) |- (#3);
}

%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% Macroname: memoconnsync
% Funktion:  Synchronisation der parallel ausgeführten Prozesse
% Parameter: #1: Erster Prozess
%            #2: Zweiter Prozess
%            #3: Verknüpfungsoperation
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
\newcommand{\memoconnsync}[3]{
    \draw[memoline] (#1) -| (#3);
    \draw[memoline] (#2) -| (#3);
}

%~~ Ende des Erweiterungspaketes



\begin{document}
\begin{tikzpicture}
    %~~ Erzeugen und plazieren der Nodes
    \memonode{startevent}{a}{0}{0}{Anfrage \\ genehmig};
    \memonode{paraconn}{t1}{1}{0}{};
    \memonode{unspecprocess}{b}{3}{2}{Logistikkosten \\ berechnen};
    \memonode{chgevent}{e}{6}{2}{Logistikkosten \\ berechnet};
    \memonode{unspecprocess}{c}{3}{-2}{Materialkosten \\ berechnen};
    \memonode{chgevent}{f}{6}{-2}{Materialkosten \\ berechnet};
    \memonode{andsync}{t2}{7}{0}{};
    \memonode{endevent}{d}{8}{0}{Kosten \\ berechnet};
    
     
    %~~ Erzeugen der Verbindungen der Nodes  
    \memoconn{a}{t1};
    \memoconnpara{t1}{b}{c}; 
    \memoconn{b}{e};
    \memoconn{c}{f};  
    \memoconnsync{e}{f}{t2};
    \memoconn{t2}{d};
    
\end{tikzpicture}
\end{document}